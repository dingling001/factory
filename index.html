<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>加工宝</title>
    <link rel="stylesheet" type="text/css" href="assets/css/api.css"/>
    <link rel="stylesheet" type="text/css" href="assets/css/style.css"/>
    <style>
        header {
            width: 100%;
            height: auto;
            background-color: #fff;
        }
    </style>
</head>
<body>
<div id="app">
</div>
</body>
</html>
<script type="text/javascript" src="assets/js/api.js"></script>
<script type="text/javascript">
    apiready = function () {
        var firstStart = $api.getStorage('firstStart');
        var fac_token = $api.getStorage('fac_token');
        api.setStatusBarStyle({
            style: 'dark',
        });
        //判断条件 
        if (!firstStart) {
            openGuide();//首次下载安装操作 
        } else {
            if (fac_token) {
                openIndex()
            } else {
                openLogin();//不是首次未登录
            }
        }
        // openGuide()
        // openIndex()
    };

    // 跳转启动页
    function openGuide() {
        //
        // var headerH = $api.offset($api.dom('header')).h;
        // $api.fixStatusBar($api.dom('header'));
        api.openFrameGroup({
            name: 'welcome',
            bounces: false,
            index: 0,
            rect: {
                x: 0,
                y: 0,
                w: 'auto',
                h: 'auto'
            },
            scrollEnabled: true,
            frames: [{
                name: 'welcome_1',
                url: './html/welcome/welcome_frame_1.html',
                bounces: false,
                bgColor: 'widget://assets/image/welcome/1.jpg'
            }, {
                name: 'welcome_2',
                url: './html/welcome/welcome_frame_2.html',
                bounces: false,
                bgColor: 'widget://assets/image/welcome/2.jpg'
            }]
        }, function (ret, err) {
            var index = ret.index;
            if (index === 1) {
                $api.setStorage('firstStart', '1');
            }
        });
    }

    // 跳转到登录
    function openLogin() {
        api.openFrame({
            name: 'login_index',
            url: './html/login/login_index.html',
            rect: {
                x: 0,
                y: 0,
                w: 'auto',
                h: 'auto'
            },
            bgColor: '#fff',
        });
    }
    // 跳转到首页
    function openIndex() {
        api.openWin({
            name: 'index_win',
            url: './html/common/index_win.html',
            slidBackEnabled: false,
            vScrollBarEnabled: false,
            hScrollBarEnabled: false,
        });
    }


</script>
